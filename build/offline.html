<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Offline - ABC Racing</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
        }

        .offline-container {
            background: white;
            border-radius: 20px;
            padding: 3rem;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            max-width: 500px;
            width: 90%;
        }

        .offline-icon {
            width: 120px;
            height: 120px;
            margin: 0 auto 2rem;
            background: #f8f9fa;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: #6c757d;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #2d3748;
        }

        p {
            font-size: 1.1rem;
            color: #718096;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .offline-actions {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: #4299e1;
            color: white;
        }

        .btn-primary:hover {
            background: #3182ce;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
        }

        .btn-secondary:hover {
            background: #cbd5e0;
        }

        .cached-content {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #e2e8f0;
        }

        .cached-content h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: #2d3748;
        }

        .content-list {
            list-style: none;
            text-align: left;
        }

        .content-list li {
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background: #f7fafc;
            border-radius: 8px;
            border-left: 4px solid #4299e1;
        }

        .content-list li a {
            color: #2d3748;
            text-decoration: none;
            font-weight: 500;
        }

        .content-list li a:hover {
            color: #4299e1;
        }

        .network-status {
            position: fixed;
            top: 1rem;
            right: 1rem;
            padding: 0.5rem 1rem;
            background: #fed7d7;
            color: #c53030;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        @media (max-width: 768px) {
            .offline-container {
                padding: 2rem;
                margin: 1rem;
            }

            h1 {
                font-size: 1.5rem;
            }

            .offline-icon {
                width: 80px;
                height: 80px;
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="network-status">
        üî¥ You're offline
    </div>

    <div class="offline-container">
        <div class="offline-icon">
            üì°
        </div>
        
        <h1>You're Offline</h1>
        <p>
            It looks like you've lost your internet connection. Don't worry! 
            You can still access your cached content and continue browsing 
            what you've saved for offline viewing.
        </p>

        <div class="offline-actions">
            <button class="btn btn-primary" onclick="window.location.reload()">
                Try Again
            </button>
            <a href="/" class="btn btn-secondary">
                Go to Homepage
            </a>
        </div>

        <div class="cached-content">
            <h2>Available Offline Content</h2>
            <ul class="content-list" id="cachedContentList">
                <li>
                    <a href="/dashboard">üìä Dashboard</a>
                </li>
                <li>
                    <a href="/drivers">üèéÔ∏è Drivers</a>
                </li>
                <li>
                    <a href="/news">üì∞ News</a>
                </li>
                <li>
                    <a href="/bookmarks">üîñ Bookmarks</a>
                </li>
            </ul>
        </div>
    </div>

    <script>
        // Check if we're back online
        function checkOnlineStatus() {
            if (navigator.onLine) {
                window.location.reload();
            }
        }

        // Listen for online/offline events
        window.addEventListener('online', checkOnlineStatus);
        
        // Check periodically
        setInterval(checkOnlineStatus, 5000);

        // Check for cached content
        async function checkCachedContent() {
            try {
                // Check if we have cached content in IndexedDB
                const request = indexedDB.open('F1RacingOffline', 1);
                
                request.onsuccess = function() {
                    const db = request.result;
                    const transaction = db.transaction(['content'], 'readonly');
                    const store = transaction.objectStore('content');
                    const getRequest = store.getAll();
                    
                    getRequest.onsuccess = function() {
                        const cachedContent = getRequest.result;
                        updateCachedContentList(cachedContent);
                    };
                };
            } catch (error) {
                console.log('No cached content available');
            }
        }

        function updateCachedContentList(cachedContent) {
            const contentList = document.getElementById('cachedContentList');
            
            if (cachedContent.length === 0) {
                contentList.innerHTML = '<li>No cached content available</li>';
                return;
            }

            const contentMap = {
                'drivers': { title: 'üèéÔ∏è Drivers', url: '/drivers' },
                'news': { title: 'üì∞ News', url: '/news' },
                'dashboard': { title: 'üìä Dashboard', url: '/dashboard' },
                'bookmarks': { title: 'üîñ Bookmarks', url: '/bookmarks' }
            };

            contentList.innerHTML = cachedContent
                .map(item => {
                    const content = contentMap[item.type];
                    if (content) {
                        return `<li><a href="${content.url}">${content.title}</a></li>`;
                    }
                    return '';
                })
                .filter(item => item !== '')
                .join('');
        }

        // Check for cached content when page loads
        checkCachedContent();

        // Add some helpful tips
        const tips = [
            'Make sure to cache content when you\'re online for better offline experience',
            'You can manage offline content in the offline controls panel',
            'The app will automatically sync when you\'re back online'
        ];

        // Show a random tip
        const randomTip = tips[Math.floor(Math.random() * tips.length)];
        console.log('üí° Tip:', randomTip);
    </script>
</body>
</html>
